if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(t){const e=this.constructor;return this.then((n=>e.resolve(t()).then((()=>n))),(n=>e.resolve(t()).then((()=>{throw n}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const t=uni.requireGlobal();ArrayBuffer=t.ArrayBuffer,Int8Array=t.Int8Array,Uint8Array=t.Uint8Array,Uint8ClampedArray=t.Uint8ClampedArray,Int16Array=t.Int16Array,Uint16Array=t.Uint16Array,Int32Array=t.Int32Array,Uint32Array=t.Uint32Array,Float32Array=t.Float32Array,Float64Array=t.Float64Array,BigInt64Array=t.BigInt64Array,BigUint64Array=t.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(t){"use strict";function e(t,e,...n){uni.__log__?uni.__log__(t,e,...n):console[t].apply(console,[...n,e])}const n={TEXT:"text",LOGIN:"login",READ_MSG:"readMsg"};class s{static getLogin(){return{uid:this.login.uid?this.login.uid:uni.getStorageSync("loginUid")}}static login(t){uni.setStorageSync("loginUid",t)}}function i(){return"undefined"!=typeof navigator&&"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}}const o="function"==typeof Proxy;class a{constructor(t,e){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=t,this.hook=e;const n={};if(t.settings)for(const a in t.settings){const e=t.settings[a];n[a]=e.defaultValue}const s=`__vue-devtools-plugin-settings__${t.id}`;let i={...n};try{const t=localStorage.getItem(s),e=JSON.parse(t);Object.assign(i,e)}catch(o){}this.fallbacks={getSettings:()=>i,setSettings(t){try{localStorage.setItem(s,JSON.stringify(t))}catch(o){}i=t}},e.on("plugin:settings:set",((t,e)=>{t===this.plugin.id&&this.fallbacks.setSettings(e)})),this.proxiedOn=new Proxy({},{get:(t,e)=>this.target?this.target.on[e]:(...t)=>{this.onQueue.push({method:e,args:t})}}),this.proxiedTarget=new Proxy({},{get:(t,e)=>this.target?this.target[e]:"on"===e?this.proxiedOn:Object.keys(this.fallbacks).includes(e)?(...t)=>(this.targetQueue.push({method:e,args:t,resolve:()=>{}}),this.fallbacks[e](...t)):(...t)=>new Promise((n=>{this.targetQueue.push({method:e,args:t,resolve:n})}))})}async setRealTarget(t){this.target=t;for(const e of this.onQueue)this.target.on[e.method](...e.args);for(const e of this.targetQueue)e.resolve(await this.target[e.method](...e.args))}}function r(t,e){const n=i(),s=i().__VUE_DEVTOOLS_GLOBAL_HOOK__,r=o&&t.enableEarlyProxy;if(!s||!n.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__&&r){const i=r?new a(t,s):null;(n.__VUE_DEVTOOLS_PLUGINS__=n.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:t,setupFn:e,proxy:i}),i&&e(i.proxiedTarget)}else s.emit("devtools-plugin:setup",t,e)}
/*!
   * vuex v4.1.0
   * (c) 2022 Evan You
   * @license MIT
   */function c(t,e){Object.keys(t).forEach((function(n){return e(t[n],n)}))}function l(t,e,n){return e.indexOf(t)<0&&(n&&n.prepend?e.unshift(t):e.push(t)),function(){var n=e.indexOf(t);n>-1&&e.splice(n,1)}}function u(t,e){t._actions=Object.create(null),t._mutations=Object.create(null),t._wrappedGetters=Object.create(null),t._modulesNamespaceMap=Object.create(null);var n=t.state;p(t,n,[],t._modules.root,!0),d(t,n,e)}function d(e,n,s){var i=e._state,o=e._scope;e.getters={},e._makeLocalGettersCache=Object.create(null);var a=e._wrappedGetters,r={},l={},u=t.effectScope(!0);u.run((function(){c(a,(function(n,s){r[s]=function(t,e){return function(){return t(e)}}(n,e),l[s]=t.computed((function(){return r[s]()})),Object.defineProperty(e.getters,s,{get:function(){return l[s].value},enumerable:!0})}))})),e._state=t.reactive({data:n}),e._scope=u,e.strict&&function(e){t.watch((function(){return e._state.data}),(function(){}),{deep:!0,flush:"sync"})}(e),i&&s&&e._withCommit((function(){i.data=null})),o&&o.stop()}function p(t,e,n,s,i){var o=!n.length,a=t._modules.getNamespace(n);if(s.namespaced&&(t._modulesNamespaceMap[a],t._modulesNamespaceMap[a]=s),!o&&!i){var r=g(e,n.slice(0,-1)),c=n[n.length-1];t._withCommit((function(){r[c]=s.state}))}var l=s.context=function(t,e,n){var s=""===e,i={dispatch:s?t.dispatch:function(n,s,i){var o=m(n,s,i),a=o.payload,r=o.options,c=o.type;return r&&r.root||(c=e+c),t.dispatch(c,a)},commit:s?t.commit:function(n,s,i){var o=m(n,s,i),a=o.payload,r=o.options,c=o.type;r&&r.root||(c=e+c),t.commit(c,a,r)}};return Object.defineProperties(i,{getters:{get:s?function(){return t.getters}:function(){return h(t,e)}},state:{get:function(){return g(t.state,n)}}}),i}(t,a,n);s.forEachMutation((function(e,n){!function(t,e,n,s){var i=t._mutations[e]||(t._mutations[e]=[]);i.push((function(e){n.call(t,s.state,e)}))}(t,a+n,e,l)})),s.forEachAction((function(e,n){var s=e.root?n:a+n,i=e.handler||e;!function(t,e,n,s){var i=t._actions[e]||(t._actions[e]=[]);i.push((function(e){var i,o=n.call(t,{dispatch:s.dispatch,commit:s.commit,getters:s.getters,state:s.state,rootGetters:t.getters,rootState:t.state},e);return(i=o)&&"function"==typeof i.then||(o=Promise.resolve(o)),t._devtoolHook?o.catch((function(e){throw t._devtoolHook.emit("vuex:error",e),e})):o}))}(t,s,i,l)})),s.forEachGetter((function(e,n){!function(t,e,n,s){if(t._wrappedGetters[e])return;t._wrappedGetters[e]=function(t){return n(s.state,s.getters,t.state,t.getters)}}(t,a+n,e,l)})),s.forEachChild((function(s,o){p(t,e,n.concat(o),s,i)}))}function h(t,e){if(!t._makeLocalGettersCache[e]){var n={},s=e.length;Object.keys(t.getters).forEach((function(i){if(i.slice(0,s)===e){var o=i.slice(s);Object.defineProperty(n,o,{get:function(){return t.getters[i]},enumerable:!0})}})),t._makeLocalGettersCache[e]=n}return t._makeLocalGettersCache[e]}function g(t,e){return e.reduce((function(t,e){return t[e]}),t)}function m(t,e,n){var s;return null!==(s=t)&&"object"==typeof s&&t.type&&(n=e,e=t,t=t.type),{type:t,payload:e,options:n}}var f="vuex:mutations",v="vuex:actions",y="vuex",_=0;function w(t,e){r({id:"org.vuejs.vuex",app:t,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:["vuex bindings"]},(function(n){n.addTimelineLayer({id:f,label:"Vuex Mutations",color:b}),n.addTimelineLayer({id:v,label:"Vuex Actions",color:b}),n.addInspector({id:y,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),n.on.getInspectorTree((function(n){if(n.app===t&&n.inspectorId===y)if(n.filter){var s=[];x(s,e._modules.root,n.filter,""),n.rootNodes=s}else n.rootNodes=[k(e._modules.root,"")]})),n.on.getInspectorState((function(n){if(n.app===t&&n.inspectorId===y){var s=n.nodeId;h(e,s),n.state=function(t,e,n){e="root"===n?e:e[n];var s=Object.keys(e),i={state:Object.keys(t.state).map((function(e){return{key:e,editable:!0,value:t.state[e]}}))};if(s.length){var o=function(t){var e={};return Object.keys(t).forEach((function(n){var s=n.split("/");if(s.length>1){var i=e,o=s.pop();s.forEach((function(t){i[t]||(i[t]={_custom:{value:{},display:t,tooltip:"Module",abstract:!0}}),i=i[t]._custom.value})),i[o]=N((function(){return t[n]}))}else e[n]=N((function(){return t[n]}))})),e}(e);i.getters=Object.keys(o).map((function(t){return{key:t.endsWith("/")?V(t):t,editable:!1,value:N((function(){return o[t]}))}}))}return i}((i=e._modules,(a=(o=s).split("/").filter((function(t){return t}))).reduce((function(t,e,n){var s=t[e];if(!s)throw new Error('Missing module "'+e+'" for path "'+o+'".');return n===a.length-1?s:s._children}),"root"===o?i:i.root._children)),"root"===s?e.getters:e._makeLocalGettersCache,s)}var i,o,a})),n.on.editInspectorState((function(n){if(n.app===t&&n.inspectorId===y){var s=n.nodeId,i=n.path;"root"!==s&&(i=s.split("/").filter(Boolean).concat(i)),e._withCommit((function(){n.set(e._state.data,i,n.state.value)}))}})),e.subscribe((function(t,e){var s={};t.payload&&(s.payload=t.payload),s.state=e,n.notifyComponentUpdate(),n.sendInspectorTree(y),n.sendInspectorState(y),n.addTimelineEvent({layerId:f,event:{time:Date.now(),title:t.type,data:s}})})),e.subscribeAction({before:function(t,e){var s={};t.payload&&(s.payload=t.payload),t._id=_++,t._time=Date.now(),s.state=e,n.addTimelineEvent({layerId:v,event:{time:t._time,title:t.type,groupId:t._id,subtitle:"start",data:s}})},after:function(t,e){var s={},i=Date.now()-t._time;s.duration={_custom:{type:"duration",display:i+"ms",tooltip:"Action duration",value:i}},t.payload&&(s.payload=t.payload),s.state=e,n.addTimelineEvent({layerId:v,event:{time:Date.now(),title:t.type,groupId:t._id,subtitle:"end",data:s}})}})}))}var b=8702998,E={label:"namespaced",textColor:16777215,backgroundColor:6710886};function V(t){return t&&"root"!==t?t.split("/").slice(-2,-1)[0]:"Root"}function k(t,e){return{id:e||"root",label:V(e),tags:t.namespaced?[E]:[],children:Object.keys(t._children).map((function(n){return k(t._children[n],e+n+"/")}))}}function x(t,e,n,s){s.includes(n)&&t.push({id:s||"root",label:s.endsWith("/")?s.slice(0,s.length-1):s||"Root",tags:e.namespaced?[E]:[]}),Object.keys(e._children).forEach((function(i){x(t,e._children[i],n,s+i+"/")}))}function N(t){try{return t()}catch(e){return e}}var T=function(t,e){this.runtime=e,this._children=Object.create(null),this._rawModule=t;var n=t.state;this.state=("function"==typeof n?n():n)||{}},C={namespaced:{configurable:!0}};C.namespaced.get=function(){return!!this._rawModule.namespaced},T.prototype.addChild=function(t,e){this._children[t]=e},T.prototype.removeChild=function(t){delete this._children[t]},T.prototype.getChild=function(t){return this._children[t]},T.prototype.hasChild=function(t){return t in this._children},T.prototype.update=function(t){this._rawModule.namespaced=t.namespaced,t.actions&&(this._rawModule.actions=t.actions),t.mutations&&(this._rawModule.mutations=t.mutations),t.getters&&(this._rawModule.getters=t.getters)},T.prototype.forEachChild=function(t){c(this._children,t)},T.prototype.forEachGetter=function(t){this._rawModule.getters&&c(this._rawModule.getters,t)},T.prototype.forEachAction=function(t){this._rawModule.actions&&c(this._rawModule.actions,t)},T.prototype.forEachMutation=function(t){this._rawModule.mutations&&c(this._rawModule.mutations,t)},Object.defineProperties(T.prototype,C);var I=function(t){this.register([],t,!1)};function M(t,e,n){if(e.update(n),n.modules)for(var s in n.modules){if(!e.getChild(s))return;M(t.concat(s),e.getChild(s),n.modules[s])}}I.prototype.get=function(t){return t.reduce((function(t,e){return t.getChild(e)}),this.root)},I.prototype.getNamespace=function(t){var e=this.root;return t.reduce((function(t,n){return t+((e=e.getChild(n)).namespaced?n+"/":"")}),"")},I.prototype.update=function(t){M([],this.root,t)},I.prototype.register=function(t,e,n){var s=this;void 0===n&&(n=!0);var i=new T(e,n);0===t.length?this.root=i:this.get(t.slice(0,-1)).addChild(t[t.length-1],i);e.modules&&c(e.modules,(function(e,i){s.register(t.concat(i),e,n)}))},I.prototype.unregister=function(t){var e=this.get(t.slice(0,-1)),n=t[t.length-1],s=e.getChild(n);s&&s.runtime&&e.removeChild(n)},I.prototype.isRegistered=function(t){var e=this.get(t.slice(0,-1)),n=t[t.length-1];return!!e&&e.hasChild(n)};var A=function(t){var e=this;void 0===t&&(t={});var n=t.plugins;void 0===n&&(n=[]);var s=t.strict;void 0===s&&(s=!1);var i=t.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new I(t),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._scope=null,this._devtools=i;var o=this,a=this.dispatch,r=this.commit;this.dispatch=function(t,e){return a.call(o,t,e)},this.commit=function(t,e,n){return r.call(o,t,e,n)},this.strict=s;var c=this._modules.root.state;p(this,c,[],this._modules.root),d(this,c),n.forEach((function(t){return t(e)}))},O={state:{configurable:!0}};A.prototype.install=function(t,e){t.provide(e||"store",this),t.config.globalProperties.$store=this,void 0!==this._devtools&&this._devtools&&w(t,this)},O.state.get=function(){return this._state.data},O.state.set=function(t){},A.prototype.commit=function(t,e,n){var s=this,i=m(t,e,n),o=i.type,a=i.payload,r={type:o,payload:a},c=this._mutations[o];c&&(this._withCommit((function(){c.forEach((function(t){t(a)}))})),this._subscribers.slice().forEach((function(t){return t(r,s.state)})))},A.prototype.dispatch=function(t,e){var n=this,s=m(t,e),i=s.type,o=s.payload,a={type:i,payload:o},r=this._actions[i];if(r){try{this._actionSubscribers.slice().filter((function(t){return t.before})).forEach((function(t){return t.before(a,n.state)}))}catch(l){}var c=r.length>1?Promise.all(r.map((function(t){return t(o)}))):r[0](o);return new Promise((function(t,e){c.then((function(e){try{n._actionSubscribers.filter((function(t){return t.after})).forEach((function(t){return t.after(a,n.state)}))}catch(l){}t(e)}),(function(t){try{n._actionSubscribers.filter((function(t){return t.error})).forEach((function(e){return e.error(a,n.state,t)}))}catch(l){}e(t)}))}))}},A.prototype.subscribe=function(t,e){return l(t,this._subscribers,e)},A.prototype.subscribeAction=function(t,e){return l("function"==typeof t?{before:t}:t,this._actionSubscribers,e)},A.prototype.watch=function(e,n,s){var i=this;return t.watch((function(){return e(i.state,i.getters)}),n,Object.assign({},s))},A.prototype.replaceState=function(t){var e=this;this._withCommit((function(){e._state.data=t}))},A.prototype.registerModule=function(t,e,n){void 0===n&&(n={}),"string"==typeof t&&(t=[t]),this._modules.register(t,e),p(this,this.state,t,this._modules.get(t),n.preserveState),d(this,this.state)},A.prototype.unregisterModule=function(t){var e=this;"string"==typeof t&&(t=[t]),this._modules.unregister(t),this._withCommit((function(){delete g(e.state,t.slice(0,-1))[t[t.length-1]]})),u(this)},A.prototype.hasModule=function(t){return"string"==typeof t&&(t=[t]),this._modules.isRegistered(t)},A.prototype.hotUpdate=function(t){this._modules.update(t),u(this,!0)},A.prototype._withCommit=function(t){var e=this._committing;this._committing=!0,t(),this._committing=e},Object.defineProperties(A.prototype,O);const S=new A({state:{msgs:{},readMsgs:[],tipCount:{}},mutations:{push(t,e){let n=s.getLogin().uid!=e.fr?e.fr:e.to;null==t.msgs[n]&&(t.msgs[n]=[]),t.msgs[n].push(e)},addReadMsgs(t,e){t.readMsgs=t.readMsgs.concat(e)},addTipCount(t,e){let n=e.uid,s=e.count;null==t.tipCount[n]&&(t.tipCount[n]=0),t.tipCount[n]+=s}}});class B{setFr(t){return this.fr=t,this}setTo(t){return this.to=t,this}setMsgType(t){return this.msgType=t,this}build(){let t=Date.now();return{msgId:t+"_"+Math.random().toString(36).substr(2,9),fr:this.fr,to:this.to,sendTimestamp:t,msgType:this.msgType}}}class j extends B{}class L extends B{setText(t){return this.text=t,this}build(){let t=super.build();return t.data={text:this.text},t}}class P extends B{setReadMsgIds(t){return this.readMsgIds=t,this}build(){let t=super.build();return t.data={readMsgIds:this.readMsgIds},t}}class U{constructor(){this.conn=null,this.socketTask=null,this.connecting=!1,this.wsIp="127.0.0.1"}static getInstance(){return this.instance||(this.instance=new U),this.instance}setWsIp(t){this.wsIp=t}connect(){try{this.socketTask=uni.connectSocket({url:"ws://"+this.wsIp+":8081/websocket",success(){return e("log","at common/ws.js:36","正在建立链接"),this.socketTask}}),this.socketTask.onMessage((t=>{e("log","at common/ws.js:43","收到数据:"+t.data),this.onMessage(JSON.parse(t.data))})),this.socketTask.onOpen((t=>{e("log","at common/ws.js:48","连接已打开");let i=(new j).setFr(s.getLogin().uid).setMsgType(n.LOGIN).build();this.send(i)})),this.socketTask.onError((t=>{e("log","at common/ws.js:59","连接报错"),this.reconnect("e")})),this.socketTask.onClose((t=>{e("log","at common/ws.js:64","链接已经关闭"),this.reconnect("c")}))}catch(t){e("log","at common/ws.js:69",t)}}reconnect(t){this.connecting||(this.connecting=!0,setTimeout((()=>{e("log","at common/ws.js:80","开始重连..."),this.connect(),this.connecting=!1}),3e3))}pushMsg(t){S.commit("push",t)}onMessage(t){S.commit("addTipCount",{uid:t.fr,count:1}),this.pushMsg(t)}send(t){let n=JSON.stringify(t);try{this.socketTask.send({data:n})}catch(s){e("log","at common/ws.js:109",s)}}}class D{setAvatar(t){return this.avatar=t,this}setName(t){return this.name=t,this}setTipCount(t){return this.tipCount=t,this}setDate(t){return this.date=t,this}setText(t){return this.text=t,this}build(){return{avatar:this.avatar,name:this.name,date:this.date,text:this.text,tipCount:this.tipCount}}}class G{static transform(t){let e=new Date,n=new Date(t);return n.getFullYear()+n.getMonth()+n.getDate()==e.getFullYear()+e.getMonth()+e.getDate()?n.getHours()+":"+n.getMinutes():n.getMonth()+"-"+n.getDate()}}const H=(t,e)=>{const n=t.__vccOpts||t;for(const[s,i]of e)n[s]=i;return n};const R=H({data:()=>({}),computed:{chatViews(){try{if(!s.getLogin().uid)return;if(0==Object.keys(S.state.msgs).length){let t="123"==s.getLogin().uid?"456":"123",e=null==S.state.tipCount[t]?0:S.state.tipCount[t];return[(new D).setAvatar("../../static/botAvatar.png").setName(t).setDate("12:00").setText("hi, sb").setTipCount(e).build()]}{let t=[];for(let e in S.state.msgs){let n=S.state.msgs[e],s=n[n.length-1],i=null==S.state.tipCount[e]?0:S.state.tipCount[e],o=(new D).setAvatar("../../static/botAvatar.png").setName(e).setDate(G.transform(s.sendTimestamp)).setText(s.data.text).setTipCount(i).build();t.push(o)}return t}}catch(t){e("log","at pages/tabBar/index.vue:84",t)}}},created(){s.getLogin().uid?U.getInstance().connect():uni.reLaunch({url:"/pages/tabBar/login"})},methods:{f(t){uni.navigateTo({url:"/pages/tabBar/chat?uid="+t})}}},[["render",function(e,n,s,i,o,a){return t.openBlock(),t.createElementBlock("view",{class:"content"},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(a.chatViews,(e=>(t.openBlock(),t.createElementBlock("scroll-view",null,[t.createElementVNode("view",{class:"chatCell",onClick:t=>a.f(e.name)},[t.createElementVNode("view",{class:"avatarView"},[t.createElementVNode("image",{class:"avatar",src:e.avatar},null,8,["src"]),e.tipCount>0?(t.openBlock(),t.createElementBlock("view",{key:0,class:"tips"},t.toDisplayString(e.tipCount),1)):t.createCommentVNode("",!0)]),t.createElementVNode("view",{class:"textView"},[t.createElementVNode("view",{class:"username"},t.toDisplayString(e.name),1),t.createElementVNode("view",{class:"text"},t.toDisplayString(e.text),1)]),t.createElementVNode("view",{class:"dateView"},t.toDisplayString(e.date),1)],8,["onClick"])])))),256))])}]]);const F=H({data:()=>({username:"",password:""}),on(){uni.switchTab({url:"/pages/tabBar/index"})},methods:{login(){s.login(this.username),uni.switchTab({url:"/pages/tabBar/index"})},u_input(t){this.username=t.detail.value},setting(){uni.showModal({title:"设置ws地址",editable:!0,success:function(t){t.confirm&&U.getInstance().setWsIp(t.content)}})}}},[["render",function(e,n,s,i,o,a){return t.openBlock(),t.createElementBlock("view",{class:"content"},[t.createElementVNode("image",{onClick:n[0]||(n[0]=(...t)=>a.setting&&a.setting(...t)),class:"setting",src:"/static/setting.png"}),t.createElementVNode("view",{style:{"text-align":"center"}},[t.createElementVNode("image",{class:"logo",src:"/static/login.png"})]),t.createElementVNode("view",null,[t.createElementVNode("input",{class:"input",type:"text",placeholder:"账号",value:o.username,onInput:n[1]||(n[1]=(...t)=>a.u_input&&a.u_input(...t))},null,40,["value"]),t.createElementVNode("input",{class:"input",type:"text",placeholder:"密码",value:o.password},null,8,["value"]),t.createElementVNode("view",{class:"confirm",onClick:n[2]||(n[2]=(...t)=>a.login&&a.login(...t))},"登录")])])}]]);const Q=H({data:()=>({message:"",olda:!1,toUid:"",val:"",scrollTop:0,inputAreaHeight:"88px",scrollRealHeight:0}),computed:{msgViewsHeight:()=>uni.getWindowInfo().windowHeight-90+"px",msgs(){try{setTimeout((()=>{uni.createSelectorQuery().selectAll(".msgView").boundingClientRect((t=>{let n=0;t.forEach((t=>{n+=t.height})),this.scrollRealHeight=n,e("log","at pages/tabBar/chat.vue:66",this.scrollRealHeight),this.scrollTop=this.scrollRealHeight-parseInt(this.msgViewsHeight),e("log","at pages/tabBar/chat.vue:68",this.scrollTop)})).exec()}),10)}catch(i){e("log","at pages/tabBar/chat.vue:73",i)}let t=null==S.state.msgs[this.toUid]?[]:S.state.msgs[this.toUid];if(0!=t.length){let e=t[t.length-1].msgId,i=S.state.readMsgs.length;if(0==i||S.state.readMsgs[i-1]!=e){let t=(new P).setFr(s.getLogin().uid).setMsgType(n.READ_MSG).setReadMsgIds([e]).build();U.getInstance().send(t)}}return S.state.tipCount[this.toUid]=0,{msgs:t,l:t.length}}},onLoad(t){this.toUid=t.uid,uni.setNavigationBarTitle({title:this.toUid})},methods:{add(t){e("log","at pages/tabBar/chat.vue:116",t)},theBlur(t){this.val=t.detail.value},confirm(t){try{let t=(new L).setFr(s.getLogin().uid).setTo(this.toUid).setMsgType(n.TEXT).setText(this.val).build();S.commit("addReadMsgs",[t.msgId]),U.getInstance().send(t),U.getInstance().pushMsg(t),this.val=""}catch(i){e("log","at pages/tabBar/chat.vue:140",i)}},dateTransform:t=>G.transform(t)}},[["render",function(e,n,s,i,o,a){return t.openBlock(),t.createElementBlock("view",{class:"content"},[t.createElementVNode("scroll-view",{style:t.normalizeStyle({height:a.msgViewsHeight}),"scroll-y":"true","scroll-top":o.scrollTop},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(a.msgs.msgs,((e,n)=>(t.openBlock(),t.createElementBlock("view",null,[t.createElementVNode("view",{class:"msgView"},[t.createElementVNode("view",null,[t.createElementVNode("image",{class:"avatar",src:"/static/botAvatar.png"})]),t.createElementVNode("view",{class:"textView"},[t.createElementVNode("view",{class:"textTitle"},[t.createElementVNode("view",{style:{"margin-right":"10px"}},t.toDisplayString(e.fr),1),t.createElementVNode("view",null,t.toDisplayString(a.dateTransform(e.sendTimestamp)),1)]),t.createElementVNode("view",{class:"textContent"},t.toDisplayString(e.data.text),1)])])])))),256))],12,["scroll-top"]),t.createElementVNode("view",{id:"abc",class:"inputAreaView",style:t.normalizeStyle({height:o.inputAreaHeight})},[t.createElementVNode("input",{class:"input",placeholder:"输入新消息",onConfirm:n[0]||(n[0]=(...t)=>a.confirm&&a.confirm(...t)),value:o.val,onInput:n[1]||(n[1]=(...t)=>a.theBlur&&a.theBlur(...t))},null,40,["value"]),t.createElementVNode("image",{src:"/static/photo.png",class:"photo"}),t.createElementVNode("image",{src:"/static/emotion.png",class:"emotion"})],4)])}]]);const q=H({data:()=>({}),methods:{quit(){s.login(""),uni.reLaunch({url:"/pages/tabBar/login"})}}},[["render",function(e,n,s,i,o,a){return t.openBlock(),t.createElementBlock("view",{class:"content"},[t.createElementVNode("view",{class:"header"},[t.createElementVNode("image",{class:"avatar",src:"/static/avatar.png"}),t.createElementVNode("view",{class:"relation"},[t.createElementVNode("view",{class:"number"},"12"),t.createElementVNode("view",{class:"text"},"好友")]),t.createElementVNode("view",{class:"relation"},[t.createElementVNode("view",{class:"number"},"47"),t.createElementVNode("view",{class:"text"},"群组")]),t.createElementVNode("view",{class:"relation"},[t.createElementVNode("view",{class:"number"},"5"),t.createElementVNode("view",{class:"text"},"聊天室")])]),t.createElementVNode("view",{style:{display:"flex","flex-direction":"row",width:"100%"}},[t.createElementVNode("view",{class:"name"},"卡卡迪曼")]),t.createElementVNode("view",{class:"sign"}," 签名：他写了个寂寞，并且一脸无辜～ "),t.createElementVNode("view",{class:"setting",onClick:n[0]||(n[0]=(...t)=>a.quit&&a.quit(...t))},"退出")])}]]);__definePage("pages/tabBar/index",R),__definePage("pages/tabBar/login",F),__definePage("pages/tabBar/chat",Q),__definePage("pages/tabBar/my",q);const W={onLaunch:function(){e("log","at App.vue:4","App Launch")},onShow:function(){e("log","at App.vue:7","App Show")},onHide:function(){e("log","at App.vue:10","App Hide")}};const{app:J,Vuex:z,Pinia:X}=function(){const e=t.createVueApp(W);return e.use(S),{app:e}}();uni.Vuex=z,uni.Pinia=X,J.provide("__globalStyles",__uniConfig.styles),J._component.mpType="app",J._component.render=()=>{},J.mount("#app")}(Vue);
